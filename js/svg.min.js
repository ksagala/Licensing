const SvgModule={Data:{Dragging:!1,Highlighted:[],Highlighting:!1,Scroll:{Top:0,Left:0,X:0,Y:0},StartWidth:0,StartHeight:0,Tag:void 0,Zoom:100,ZoomX:0,ZoomY:0,Zooming:!1},getSvgXml:function(){let t=(new XMLSerializer).serializeToString(this.Data.Tag);return Common.isIE&&(t=t.replace('xmlns:NS1="" NS1:xmlns:ev="http://www.w3.org/2001/xml-events"','xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events"')),t},injectHighlightStyles:function(){let t=this.Data.Tag.getElementById("m365MapsHighlights");t&&this.Data.Tag.removeChild(t);const e='<style id="m365MapsHighlights">.highlight1{fill:'+Common.Settings.Highlight1+"!important;transition:0.4s;}.highlight2{fill:"+Common.Settings.Highlight2+"!important;transition:0.4s;}.highlight3{fill:"+Common.Settings.Highlight3+"!important;transition:0.4s;}</style>";t=Common.createElementFromHtml(e),this.Data.Tag.appendChild(t)},clearAllHighlights:function(){for(let t=0;t<this.Data.Highlighted.length;t+=1){const e=this.Data.Highlighted[t];e.className.baseVal=e.className.baseVal.replace("highlight1","").replace("highlight2","").replace("highlight3","")}this.Data.Highlighted=[]},findHighlightTarget:function(t){let e=t;if("tspan"===e.nodeName&&(e=e.parentNode),"text"===e.nodeName&&(e=e.parentNode),"g"===e.nodeName){let t=e.getElementsByTagName("rect");if(0===t.length&&(t=e.getElementsByTagName("path")),0===t.length)return null;e=t.item(0)}return"rect"===e.nodeName||"path"===e.nodeName?e:null},sizeSvg:function(){if(!this.Data.Tag)return;this.Data.Tag.style.display="inline";let t=.985;switch(Common.Settings.Zoom){case"Fit":t*=Math.min(window.innerWidth/this.Data.Tag.clientWidth,window.innerHeight/this.Data.Tag.clientHeight);break;case"Fit Width":t*=window.innerWidth/this.Data.Tag.clientWidth;break;case"Fit Height":t*=window.innerHeight/this.Data.Tag.clientHeight;break;case"Fill":t*=Math.max(window.innerWidth/this.Data.Tag.clientWidth,window.innerHeight/this.Data.Tag.clientHeight);break;default:return void Common.showError("Unexpected Zoom setting value: "+Common.Settings.Zoom)}const e=Math.floor(this.Data.Tag.clientWidth*t),i=Math.floor(this.Data.Tag.clientHeight*t);this.Data.Tag.style.width=e+"px",this.Data.Tag.style.height=i+"px",this.Data.StartWidth=e,this.Data.StartHeight=i,this.Data.Zoom=100},auxClickEvent:function(t){t.button===Common.Mouse.Button.Middle&&(t.preventDefault(),SvgModule.Data.Highlighting?SvgModule.clearAllHighlights():SvgModule.sizeSvg())},clickEvent:function(t){if(t.button!==Common.Mouse.Button.Middle){if(SvgModule.Data.Dragging)t.preventDefault(),SvgModule.Data.Dragging=!1;else if(SvgModule.Data.Highlighting){const e=SvgModule.findHighlightTarget(t.target);if(null===e)return;t.preventDefault();const i=e.className.baseVal.split(" ");let a="";if(i.contains("highlight1")?(i.remove("highlight1"),a="highlight1"):i.contains("highlight2")?(i.remove("highlight2"),a="highlight2"):i.contains("highlight3")&&(i.remove("highlight3"),a="highlight3"),""===a){let a="";a=t.ctrlKey?"highlight3":t.shiftKey?"highlight2":"highlight1",i.push(a),SvgModule.Data.Highlighted.push(e)}else SvgModule.Data.Highlighted.remove(e);e.className.baseVal=i.join(" ")}}else SvgModule.auxClickEvent(t)},mouseDown:function(t){t.buttons===Common.Mouse.Buttons.Left?(SvgModule.Data.Scroll.Left=document.documentElement.scrollLeft,SvgModule.Data.Scroll.Top=document.documentElement.scrollTop,SvgModule.Data.Scroll.X=t.clientX,SvgModule.Data.Scroll.Y=t.clientY):t.buttons===Common.Mouse.Buttons.Middle&&t.preventDefault()},mouseMove:function(t){t.buttons===Common.Mouse.Buttons.Left&&"INPUT"!==t.target.nodeName&&(SvgModule.Data.Scroll.X===t.clientX&&SvgModule.Data.Scroll.Y===t.clientY||(t.preventDefault(),SvgModule.Data.Dragging=!0,window.scroll(SvgModule.Data.Scroll.Left+SvgModule.Data.Scroll.X-t.clientX,SvgModule.Data.Scroll.Top+SvgModule.Data.Scroll.Y-t.clientY)))},zoomTimer:function(){if(!SvgModule.Data.Zooming)return;SvgModule.Data.Zooming=!1;const t=SvgModule.Data.Tag.clientWidth,e=SvgModule.Data.Tag.clientHeight,i=Math.floor(SvgModule.Data.StartWidth*SvgModule.Data.Zoom/100),a=Math.floor(SvgModule.Data.StartHeight*SvgModule.Data.Zoom/100);SvgModule.Data.Tag.style.width=i+"px",SvgModule.Data.Tag.style.height=a+"px";const o=i/t,l=a/e,n=SvgModule.Data.ZoomX*o,g=SvgModule.Data.ZoomY*l,h=n-SvgModule.Data.ZoomX,s=g-SvgModule.Data.ZoomY;window.scroll(document.documentElement.scrollLeft+h,document.documentElement.scrollTop+s)},wheelEvent:function(t){SvgModule.Data.Tag&&(t.preventDefault(),t.deltaY<.1&&t.deltaY>-.1||(SvgModule.Data.Zoom<100?SvgModule.Data.Zoom-=t.deltaY/2:SvgModule.Data.Zoom-=t.deltaY,SvgModule.Data.Zoom>1e3?SvgModule.Data.Zoom=1e3:SvgModule.Data.Zoom<10&&(SvgModule.Data.Zoom=10),SvgModule.Data.ZoomX=t.pageX,SvgModule.Data.ZoomY=t.pageY,SvgModule.Data.Zooming=!0))},registerEvents:function(){this.Data.Tag.addEventListener("click",this.clickEvent),this.Data.Tag.addEventListener("auxclick",this.auxClickEvent),window.addEventListener("mousedown",this.mouseDown),window.addEventListener("mousemove",this.mouseMove),window.addEventListener("wheel",this.wheelEvent,{passive:!1}),setInterval(SvgModule.zoomTimer,100)}};